<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Guide for Rcwl • Rcwl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="User Guide for Rcwl">
<meta property="og:description" content="Rcwl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rcwl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Rcwl.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Rcwl_files/header-attrs-2.6/header-attrs.js"></script><script src="Rcwl_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="Rcwl_files/viz-1.8.2/viz.js"></script><link href="Rcwl_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="Rcwl_files/grViz-binding-1.0.6.1/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>User Guide for Rcwl</h1>
                        <h4 class="author">Qiang Hu</h4>
            
            <h4 class="date">2021-02-03</h4>
      
      
      <div class="hidden name"><code>Rcwl.Rmd</code></div>

    </div>

    
    
<!-- ```{r setup, include = FALSE} -->
<!-- knitr::opts_chunk$set( -->
<!--   collapse = TRUE, -->
<!--   comment = "#>" -->
<!-- ) -->
<!-- ``` -->
<p>The <code>Rcwl</code> package is aimed to be a simple and user-friendly way to manage command line tools and build data analysis pipelines in R using Common Workflow Language (CWL). It can be a bridge between heavy bioinformatics tools and pipeline to R/Bioconductor. More details about CWL can be found at <a href="http://www.commonwl.org" class="uri">http://www.commonwl.org</a>.</p>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<ol style="list-style-type: decimal">
<li>Download the package.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"Rcwl"</span><span class="op">)</span></code></pre></div>
<p>The development version is also available to download from Github.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"hubentu/Rcwl"</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Load the package into the R session.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Rcwl</span><span class="op">)</span></code></pre></div>
</div>
<div id="first-example" class="section level1">
<h1 class="hasAnchor">
<a href="#first-example" class="anchor"></a>First Example</h1>
<p>The main class and constructor function is <code>cwlProcess</code>, which wrap a command line tool and its parameters in a <code>cwlProcess</code> object. Let’s start with a simple example, <code>echo hello world</code>.</p>
<p>First, we load the package and then define the input parameter for “echo”, a string without a prefix. Just an <code>id</code> option required.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"sth"</span><span class="op">)</span></code></pre></div>
<p>Second, create a <code>cwlProcess</code> object with <code>baseCommand</code> for the command to execute and <code>InputParamList</code> for the input parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">echo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"echo"</span>, inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">input1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now we have a command object to run. Let’s send a string “Hello World!” to the object. Without defining the outputs, it will stream standard output to a temporary file by default.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">echo</span><span class="op">$</span><span class="va">sth</span> <span class="op">&lt;-</span> <span class="st">"Hello World!"</span>
<span class="va">echo</span></code></pre></div>
<pre><code>## class: cwlProcess 
##  cwlClass: CommandLineTool 
##  cwlVersion: v1.0 
##  baseCommand: echo 
## inputs:
##   sth (string):  Hello World!
## outputs:
## output:
##   type: stdout</code></pre>
<p>Let’s run it. A list including the command executed, temporary output and logs. The output directory is the current folder by default, but it can be changed by setting <code>outdir</code> option. All standard out and standard error stream can also be printed by setting <code>stderr = ""</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">echo</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r1</span></code></pre></div>
<pre><code>## List of length 3
## names(3): command output logs</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">output</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Hello World!"</code></pre>
<p>The <code>writeCWL</code> function will write the cwlProcess object to a CWL file for the command and YML for the inputs. Then it will invoke <code>cwl-runner</code> by default to execute the two files. Thus the command tool <code>cwl-runner</code> is required to be installed and available in the system path.</p>
</div>
<div id="commandline-tool" class="section level1">
<h1 class="hasAnchor">
<a href="#commandline-tool" class="anchor"></a>Commandline tool</h1>
<p>The package provides functions to define a CWL syntax for Command Line Tools in a intuitive way. The functions were developped based on the CWL Command Line Tool Description (v1.0). More details can be found in the offical document: <a href="https://www.commonwl.org/v1.0/CommandLineTool.html" class="uri">https://www.commonwl.org/v1.0/CommandLineTool.html</a>.</p>
<div id="input-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#input-parameters" class="anchor"></a>Input Parameters</h2>
<div id="essential-input-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#essential-input-parameters" class="anchor"></a>Essential Input parameters</h3>
<p>For the input parameters, three options need to be defined usually, <em>id</em>, <em>type</em>, and <em>prefix</em>. The type can be <em>string</em>, <em>int</em>, <em>long</em>, <em>float</em>, <em>double</em>, and so on. More detail can be found at: <a href="https://www.commonwl.org/v1.0/CommandLineTool.html#CWLType" class="uri">https://www.commonwl.org/v1.0/CommandLineTool.html#CWLType</a>.</p>
<p>Here is an example from <a href="http://www.commonwl.org/user_guide/03-input/">CWL user guide</a>. Here we defined an <code>echo</code> with different type of input parameters by <code>InputParam</code>. The <code>stdout</code> option can be used to caputre the standard output stream to a file.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"flag"</span>, type <span class="op">=</span> <span class="st">"boolean"</span>, prefix <span class="op">=</span> <span class="st">"-f"</span><span class="op">)</span>
<span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"string"</span>, type <span class="op">=</span> <span class="st">"string"</span>, prefix <span class="op">=</span> <span class="st">"-s"</span><span class="op">)</span>
<span class="va">e3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"int"</span>, type <span class="op">=</span> <span class="st">"int"</span>, prefix <span class="op">=</span> <span class="st">"-i"</span><span class="op">)</span>
<span class="va">e4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"file"</span>, type <span class="op">=</span> <span class="st">"File"</span>, prefix <span class="op">=</span> <span class="st">"--file="</span>, separate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">echoA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"echo"</span>,
                  inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">e1</span>, <span class="va">e2</span>, <span class="va">e3</span>, <span class="va">e4</span><span class="op">)</span>,
                  stdout <span class="op">=</span> <span class="st">"output.txt"</span><span class="op">)</span></code></pre></div>
<p>Then we give it a try by setting values for the inputs.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">echoA</span><span class="op">$</span><span class="va">flag</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>
<span class="va">echoA</span><span class="op">$</span><span class="va">string</span> <span class="op">&lt;-</span> <span class="st">"Hello"</span>
<span class="va">echoA</span><span class="op">$</span><span class="va">int</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="va">tmpfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/write.html">write</a></span><span class="op">(</span><span class="st">"World"</span>, <span class="va">tmpfile</span><span class="op">)</span>
<span class="va">echoA</span><span class="op">$</span><span class="va">file</span> <span class="op">&lt;-</span> <span class="va">tmpfile</span>

<span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">echoA</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r2</span><span class="op">$</span><span class="va">command</span></code></pre></div>
<pre><code>## [1] "\033[1;30mINFO\033[0m [job file1793f256b2a3f.cwl] /private/tmp/docker_tmppdv984fv$ echo \\"                                                  
## [2] "    --file=/private/var/folders/pv/qm6yts0j7hdgggvq53hrzfr0vfyhvv/T/tmpnt3vjtth/stg0832ec91-9c05-4edc-9aa1-b50ad101a303/file1793f635415eb \\"
## [3] "    -f \\"                                                                                                                                   
## [4] "    -i \\"                                                                                                                                   
## [5] "    1 \\"                                                                                                                                    
## [6] "    -s \\"                                                                                                                                   
## [7] "    Hello &gt; /private/tmp/docker_tmppdv984fv/output.txt"</code></pre>
<p>The command shows the parameters work as we defined. The parameter order is in alphabetical by default, but the option of “position” can be used to fix the orders.</p>
</div>
<div id="array-inputs" class="section level3">
<h3 class="hasAnchor">
<a href="#array-inputs" class="anchor"></a>Array Inputs</h3>
<p>A similar example to CWL user guide. We can define three different type of array as inputs.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"A"</span>, type <span class="op">=</span> <span class="st">"string[]"</span>, prefix <span class="op">=</span> <span class="st">"-A"</span><span class="op">)</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"B"</span>,
                 type <span class="op">=</span> <span class="fu"><a href="../reference/InputArrayParam-class.html">InputArrayParam</a></span><span class="op">(</span>items <span class="op">=</span> <span class="st">"string"</span>,
                                        prefix<span class="op">=</span><span class="st">"-B="</span>, separate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="va">a3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"C"</span>, type <span class="op">=</span> <span class="st">"string[]"</span>, prefix <span class="op">=</span> <span class="st">"-C="</span>,
                 itemSeparator <span class="op">=</span> <span class="st">","</span>, separate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">echoB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"echo"</span>,
                 inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span>, <span class="va">a3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Then set values for the three inputs.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">echoB</span><span class="op">$</span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="va">echoB</span><span class="op">$</span><span class="va">B</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="va">echoB</span><span class="op">$</span><span class="va">C</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>
<span class="va">echoB</span></code></pre></div>
<pre><code>## class: cwlProcess 
##  cwlClass: CommandLineTool 
##  cwlVersion: v1.0 
##  baseCommand: echo 
## inputs:
##   A (string[]): -A a b c
##   B:
##     type: array
##     prefix: -B= d e f
##   C (string[]): -C= g h i
## outputs:
## output:
##   type: stdout</code></pre>
<p>Now we can check whether the command behaves as we expected.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">echoB</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r3</span><span class="op">$</span><span class="va">command</span></code></pre></div>
<pre><code>## [1] "\033[1;30mINFO\033[0m [job file1793f5f445e92.cwl] /private/tmp/docker_tmpoyc_j95q$ echo \\"
## [2] "    -A \\"                                                                                 
## [3] "    a \\"                                                                                  
## [4] "    b \\"                                                                                  
## [5] "    c \\"                                                                                  
## [6] "    -B=d \\"                                                                               
## [7] "    -B=e \\"                                                                               
## [8] "    -B=f \\"                                                                               
## [9] "    -C=g,h,i &gt; /private/tmp/docker_tmpoyc_j95q/c9d1fbec147a75a3e57ddcb33d4e6d827462ac9e"</code></pre>
</div>
</div>
<div id="output-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#output-parameters" class="anchor"></a>Output Parameters</h2>
<div id="capturing-output" class="section level3">
<h3 class="hasAnchor">
<a href="#capturing-output" class="anchor"></a>Capturing Output</h3>
<p>The outputs, similar to the inputs, is a list of output parameters. Three options <em>id</em>, <em>type</em> and <em>glob</em> can be defined. The glob option is used to define a pattern to find files relative to the output directory.</p>
<p>Here is an example to unzip a compressed <code>gz</code> file. First, we generate a compressed R script file.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">zzfil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"sample.R.gz"</span><span class="op">)</span>
<span class="va">zz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/connections.html">gzfile</a></span><span class="op">(</span><span class="va">zzfil</span>, <span class="st">"w"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"sample(1:10, 5)"</span>, file <span class="op">=</span> <span class="va">zz</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/connections.html">close</a></span><span class="op">(</span><span class="va">zz</span><span class="op">)</span></code></pre></div>
<p>We define a <code>cwlProcess</code> object to use “gzip” to uncompress a input file.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ofile</span> <span class="op">&lt;-</span> <span class="st">"sample.R"</span>
<span class="va">z1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"uncomp"</span>, type <span class="op">=</span> <span class="st">"boolean"</span>, prefix <span class="op">=</span> <span class="st">"-d"</span><span class="op">)</span>
<span class="va">z2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"out"</span>, type <span class="op">=</span> <span class="st">"boolean"</span>, prefix <span class="op">=</span> <span class="st">"-c"</span><span class="op">)</span>
<span class="va">z3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"zfile"</span>, type <span class="op">=</span> <span class="st">"File"</span><span class="op">)</span>
<span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutputParam-class.html">OutputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"rfile"</span>, type <span class="op">=</span> <span class="st">"File"</span>, glob <span class="op">=</span> <span class="va">ofile</span><span class="op">)</span>
<span class="va">gz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"gzip"</span>,
               inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">z1</span>, <span class="va">z2</span>, <span class="va">z3</span><span class="op">)</span>,
               outputs <span class="op">=</span> <span class="fu"><a href="../reference/OutputParamList-class.html">OutputParamList</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span>,
               stdout <span class="op">=</span> <span class="va">ofile</span><span class="op">)</span></code></pre></div>
<p>Now the <code>gz</code> object can be used to uncompress the previous generated compressed file.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gz</span><span class="op">$</span><span class="va">uncomp</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>
<span class="va">gz</span><span class="op">$</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>
<span class="va">gz</span><span class="op">$</span><span class="va">zfile</span> <span class="op">&lt;-</span> <span class="va">zzfil</span>
<span class="va">r4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">gz</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r4</span><span class="op">$</span><span class="va">output</span></code></pre></div>
<pre><code>## [1] "/var/folders/pv/qm6yts0j7hdgggvq53hrzfr0vfyhvv/T/RtmpiSqthE/sample.R"</code></pre>
<p>Or we can use <code>arguments</code> to set some default parameters.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"zfile"</span>, type <span class="op">=</span> <span class="st">"File"</span><span class="op">)</span>
<span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutputParam-class.html">OutputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"rfile"</span>, type <span class="op">=</span> <span class="st">"File"</span>, glob <span class="op">=</span> <span class="va">ofile</span><span class="op">)</span>
<span class="va">Gz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"gzip"</span>,
               arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"-d"</span>, <span class="st">"-c"</span><span class="op">)</span>,
               inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">z1</span><span class="op">)</span>,
               outputs <span class="op">=</span> <span class="fu"><a href="../reference/OutputParamList-class.html">OutputParamList</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span>,
               stdout <span class="op">=</span> <span class="va">ofile</span><span class="op">)</span>
<span class="va">Gz</span></code></pre></div>
<pre><code>## class: cwlProcess 
##  cwlClass: CommandLineTool 
##  cwlVersion: v1.0 
##  baseCommand: gzip 
## arguments: -d -c 
## inputs:
##   zfile (File):  
## outputs:
## rfile:
##   type: File
##   outputBinding:
##     glob: sample.R
## stdout: sample.R</code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Gz</span><span class="op">$</span><span class="va">zfile</span> <span class="op">&lt;-</span> <span class="va">zzfil</span>
<span class="va">r4a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">Gz</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<p>To make it for general usage, we can define a pattern with javascript to glob the output, which require <code>node</code> from “nodejs” to be installed in your system PATH.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfile</span> <span class="op">&lt;-</span> <span class="st">"$(inputs.zfile.path.split('/').slice(-1)[0].split('.').slice(0,-1).join('.'))"</span></code></pre></div>
<p>Or we can use the CWL built in file property, <code>nameroot</code>, directly.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfile</span> <span class="op">&lt;-</span> <span class="st">"$(inputs.zfile.nameroot)"</span>
<span class="va">o2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutputParam-class.html">OutputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"rfile"</span>, type <span class="op">=</span> <span class="st">"File"</span>, glob <span class="op">=</span> <span class="va">pfile</span><span class="op">)</span>
<span class="va">req1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/requireDocker.html">requireJS</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">GZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"gzip"</span>,
               arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"-d"</span>, <span class="st">"-c"</span><span class="op">)</span>,
               requirements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="co">## assign list(req1) if node installed.</span>
               inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">z1</span><span class="op">)</span>,
               outputs <span class="op">=</span> <span class="fu"><a href="../reference/OutputParamList-class.html">OutputParamList</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span>,
               stdout <span class="op">=</span> <span class="va">pfile</span><span class="op">)</span>
<span class="va">GZ</span><span class="op">$</span><span class="va">zfile</span> <span class="op">&lt;-</span> <span class="va">zzfil</span>
<span class="va">r4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">GZ</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
</div>
<div id="array-outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#array-outputs" class="anchor"></a>Array Outputs</h3>
<p>We can also capture multiple output files with <code>glob</code> pattern.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"a"</span>, type <span class="op">=</span> <span class="fu"><a href="../reference/InputArrayParam-class.html">InputArrayParam</a></span><span class="op">(</span>items <span class="op">=</span> <span class="st">"string"</span><span class="op">)</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutputParam-class.html">OutputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"b"</span>, type <span class="op">=</span> <span class="fu"><a href="../reference/OutputArrayParam-class.html">OutputArrayParam</a></span><span class="op">(</span>items <span class="op">=</span> <span class="st">"File"</span><span class="op">)</span>, glob <span class="op">=</span> <span class="st">"*.txt"</span><span class="op">)</span>
<span class="va">touch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"touch"</span>, inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, outputs <span class="op">=</span> <span class="fu"><a href="../reference/OutputParamList-class.html">OutputParamList</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="va">touch</span><span class="op">$</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a.txt"</span>, <span class="st">"b.gz"</span>, <span class="st">"c.txt"</span><span class="op">)</span>
<span class="va">r5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">touch</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r5</span><span class="op">$</span><span class="va">output</span></code></pre></div>
<pre><code>## [1] "/var/folders/pv/qm6yts0j7hdgggvq53hrzfr0vfyhvv/T/RtmpiSqthE/a.txt"
## [2] "/var/folders/pv/qm6yts0j7hdgggvq53hrzfr0vfyhvv/T/RtmpiSqthE/c.txt"</code></pre>
<p>The “touch” comand generated three files, but the output shows that only two files with “.txt” suffix return in the output directory except the “gz” file, which behaves right as we defined in the “glob” pattern.</p>
</div>
</div>
</div>
<div id="running-tools-in-docker" class="section level1">
<h1 class="hasAnchor">
<a href="#running-tools-in-docker" class="anchor"></a>Running Tools in Docker</h1>
<p>The CWL can work with docker to simplify your software management and communicate files between host and container. The docker container can be defined by the <code>hints</code> or <code>requirements</code> option.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"rfile"</span>, type <span class="op">=</span> <span class="st">"File"</span><span class="op">)</span>
<span class="va">req1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/requireDocker.html">requireDocker</a></span><span class="op">(</span><span class="st">"r-base"</span><span class="op">)</span>
<span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"Rscript"</span>,
                inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span>,
                stdout <span class="op">=</span> <span class="st">"output.txt"</span>,
                hints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">req1</span><span class="op">)</span><span class="op">)</span>
<span class="va">doc</span><span class="op">$</span><span class="va">rfile</span> <span class="op">&lt;-</span> <span class="va">r4</span><span class="op">$</span><span class="va">output</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></code></pre></div>
<p>The tools defined with docker requirements can also be run locally by disabling the docker option. In case your <code>Rscript</code> depends some local libraries to run, an option from <code>cwltools</code>, “–preserve-entire-environment”, can be used to pass all environment variables.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r6a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">doc</span>, docker <span class="op">=</span> <span class="cn">FALSE</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,
              cwlArgs <span class="op">=</span> <span class="st">"--preserve-entire-environment"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
</div>
<div id="running-tools-in-cluster-server" class="section level1">
<h1 class="hasAnchor">
<a href="#running-tools-in-cluster-server" class="anchor"></a>Running Tools in Cluster server</h1>
<p>The CWL also can work in high performance clusters with batch-queuing system, such as SGE, PBS, SLURM and so on, using the Bioconductor package <code>BiocParallel</code>. Here is an example to submit jobs with “Multiicore” and “SGE”. A more detailed example can be found (<a href="https://hubentu.github.io/others/Rcwl_RNASeq.html" class="uri">https://hubentu.github.io/others/Rcwl_RNASeq.html</a>).</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel">BiocParallel</a></span><span class="op">)</span>
<span class="va">sth.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sth.list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span>

<span class="co">## submit with multicore</span>
<span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWLBatch.html">runCWLBatch</a></span><span class="op">(</span>cwl <span class="op">=</span> <span class="va">echo</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, inputList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sth <span class="op">=</span> <span class="va">sth.list</span><span class="op">)</span>,
                       BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html">MulticoreParam</a></span><span class="op">(</span><span class="fl">26</span><span class="op">)</span><span class="op">)</span>

<span class="co">## submit with SGE</span>
<span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWLBatch.html">runCWLBatch</a></span><span class="op">(</span>cwl <span class="op">=</span> <span class="va">echo</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, inputList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sth <span class="op">=</span> <span class="va">sth.list</span><span class="op">)</span>,
                       BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/BatchtoolsParam-class.html">BatchtoolsParam</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">26</span>, cluster <span class="op">=</span> <span class="st">"sge"</span>,
                                                 resources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>queue <span class="op">=</span> <span class="st">"all.q"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="writing-pipeline" class="section level1">
<h1 class="hasAnchor">
<a href="#writing-pipeline" class="anchor"></a>Writing Pipeline</h1>
<p>We can connect multiple tools together into a pipeline. Here is an example to uncompress an R script and execute it with <code>Rscript</code>.</p>
<p>Here we define a simple <code>Rscript</code> tool without using docker.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"rfile"</span>, type <span class="op">=</span> <span class="st">"File"</span><span class="op">)</span>
<span class="va">Rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"Rscript"</span>,
               inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">)</span>
<span class="va">Rs</span></code></pre></div>
<pre><code>## class: cwlProcess 
##  cwlClass: CommandLineTool 
##  cwlVersion: v1.0 
##  baseCommand: Rscript 
## inputs:
##   rfile (File):  
## outputs:
## output:
##   type: stdout</code></pre>
<p>Test run:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Rs</span><span class="op">$</span><span class="va">rfile</span> <span class="op">&lt;-</span> <span class="va">r4</span><span class="op">$</span><span class="va">output</span>
<span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">Rs</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="va">tres</span><span class="op">$</span><span class="va">output</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "[1] 10  5  6  4  9"</code></pre>
<p>The pipeline includes two steps, decompressed by the predefined tool <code>GZ</code> and compiled by <code>Rs</code>. The input file is a compressed file for the first “Uncomp” step.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"cwl_zfile"</span>, type <span class="op">=</span> <span class="st">"File"</span><span class="op">)</span>
<span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Step.html">Step</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Uncomp"</span>, run <span class="op">=</span> <span class="va">GZ</span>,
           In <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>zfile <span class="op">=</span> <span class="st">"cwl_zfile"</span><span class="op">)</span><span class="op">)</span>
<span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Step.html">Step</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Compile"</span>, run <span class="op">=</span> <span class="va">Rs</span>,
           In <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rfile <span class="op">=</span> <span class="st">"Uncomp/rfile"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The input “cwl_zfile”, it is assigned to the <code>GZ</code> input <code>zfile</code> ih the frist step. Then the input of ‘Rs’ in the “Compile” step is assigned by the output “rfile” of the “GZ” tool in the previous step (“Uncomp/rfile”). The <code>run</code> option refer to the corresponding <code>cwlProcess</code> object and the <code>In</code> option in steps should be linked to the input parameters defined by <code>cwlWorkflow</code>.</p>
<p>The pipeline output would be output of the ‘Compile’ step from the tool <code>Rs</code>.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutputParam-class.html">OutputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"cwl_cout"</span>, type <span class="op">=</span> <span class="st">"File"</span>, outputSource <span class="op">=</span> <span class="st">"Compile/output"</span><span class="op">)</span></code></pre></div>
<p>The <code>cwlWorkflow</code> is used to collect <code>inputs</code> and <code>outputs</code> from previous step. Then we can simply use <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> to connect all steps.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cwl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlWorkflow-class.html">cwlWorkflow</a></span><span class="op">(</span>inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">i1</span><span class="op">)</span>,
                    outputs <span class="op">=</span> <span class="fu"><a href="../reference/OutputParamList-class.html">OutputParamList</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span><span class="op">)</span>
<span class="va">cwl</span> <span class="op">&lt;-</span> <span class="va">cwl</span> <span class="op">+</span> <span class="va">s1</span> <span class="op">+</span> <span class="va">s2</span>
<span class="va">cwl</span></code></pre></div>
<pre><code>## class: cwlWorkflow 
##  cwlClass: Workflow 
##  cwlVersion: v1.0 
## inputs:
##   cwl_zfile (File):  
## outputs:
## cwl_cout:
##   type: File
##   outputSource: Compile/output
## steps:
## Uncomp:
##   run: Uncomp.cwl
##   in:
##     zfile: cwl_zfile
##   out:
##   - rfile
## Compile:
##   run: Compile.cwl
##   in:
##     rfile: Uncomp/rfile
##   out:
##   - output</code></pre>
<p>Let’s run the pipeline.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cwl</span><span class="op">$</span><span class="va">cwl_zfile</span> <span class="op">&lt;-</span> <span class="va">zzfil</span>
<span class="va">r7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">cwl</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="va">r7</span><span class="op">$</span><span class="va">output</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "[1] 8 2 9 1 5"</code></pre>
<p>Tips: Sometimes, we need to adjust some arguments of certain tools in a pipeline besides of parameter inputs. The function <code>arguments</code> can help to modify arguments for a tool, tool in a pipeline, or even tool in a sub-workflow. For example,</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cwlVersion.html">arguments</a></span><span class="op">(</span><span class="va">cwl</span>, step <span class="op">=</span> <span class="st">"Uncomp"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"-d"</span>, <span class="st">"-c"</span>, <span class="st">"-f"</span><span class="op">)</span>
<span class="fu"><a href="../reference/runs.html">runs</a></span><span class="op">(</span><span class="va">cwl</span><span class="op">)</span><span class="op">$</span><span class="va">Uncomp</span></code></pre></div>
<pre><code>## class: cwlProcess 
##  cwlClass: CommandLineTool 
##  cwlVersion: v1.0 
##  baseCommand: gzip 
## arguments: -d -c -f 
## inputs:
##   zfile (File):  /private/var/folders/pv/qm6yts0j7hdgggvq53hrzfr0vfyhvv/T/RtmpiSqthE/sample.R.gz
## outputs:
## rfile:
##   type: File
##   outputBinding:
##     glob: $(inputs.zfile.nameroot)
## stdout: $(inputs.zfile.nameroot)</code></pre>
<div id="scattering-pipeline" class="section level2">
<h2 class="hasAnchor">
<a href="#scattering-pipeline" class="anchor"></a>Scattering pipeline</h2>
<p>The scattering feature can specifies the associated workflow step or subworkflow to execute separately over a list of input elements. To use this feature, <code>ScatterFeatureRequirement</code> must be specified in the workflow requirements. Different <code>scatter</code> methods can be used in the associated step to decompose the input into a discrete set of jobs. More details can be found at: <a href="https://www.commonwl.org/v1.0/Workflow.html#WorkflowStep" class="uri">https://www.commonwl.org/v1.0/Workflow.html#WorkflowStep</a>.</p>
<p>Here is an example to execute multiple R scripts. First, we need to set the input and output types to be array of “File”, and add the requirments. In the “Compile” step, the scattering input is required to be set with the <code>scatter</code> option.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"cwl_rfiles"</span>, type <span class="op">=</span> <span class="st">"File[]"</span><span class="op">)</span>
<span class="va">o2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutputParam-class.html">OutputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"cwl_couts"</span>, type <span class="op">=</span> <span class="st">"File[]"</span>, outputSource <span class="op">=</span> <span class="st">"Compile/output"</span><span class="op">)</span>
<span class="va">req1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/requireDocker.html">requireScatter</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">cwl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlWorkflow-class.html">cwlWorkflow</a></span><span class="op">(</span>requirements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">req1</span><span class="op">)</span>,
                    inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">i2</span><span class="op">)</span>,
                    outputs <span class="op">=</span> <span class="fu"><a href="../reference/OutputParamList-class.html">OutputParamList</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">)</span>
<span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Step.html">Step</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Compile"</span>, run <span class="op">=</span> <span class="va">Rs</span>,
           In <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rfile <span class="op">=</span> <span class="st">"cwl_rfiles"</span><span class="op">)</span>,
           scatter <span class="op">=</span> <span class="st">"rfile"</span><span class="op">)</span>
<span class="va">cwl2</span> <span class="op">&lt;-</span> <span class="va">cwl2</span> <span class="op">+</span> <span class="va">s1</span>
<span class="va">cwl2</span></code></pre></div>
<pre><code>## class: cwlWorkflow 
##  cwlClass: Workflow 
##  cwlVersion: v1.0 
## requirements:
## - class: ScatterFeatureRequirement
## inputs:
##   cwl_rfiles (File[]):  
## outputs:
## cwl_couts:
##   type: File[]
##   outputSource: Compile/output
## steps:
## Compile:
##   run: Compile.cwl
##   in:
##     rfile: cwl_rfiles
##   out:
##   - output
##   scatter: rfile</code></pre>
<p>Multiple R scripts can be assigned to the workflow inputs and executed.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cwl2</span><span class="op">$</span><span class="va">cwl_rfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">r4b</span><span class="op">$</span><span class="va">output</span>, <span class="va">r4b</span><span class="op">$</span><span class="va">output</span><span class="op">)</span>
<span class="va">r8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">cwl2</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r8</span><span class="op">$</span><span class="va">output</span></code></pre></div>
<pre><code>## [1] "/var/folders/pv/qm6yts0j7hdgggvq53hrzfr0vfyhvv/T/RtmpiSqthE/8cafc316c0bf32ba1bffad801cd3b7b2d886ff24"  
## [2] "/var/folders/pv/qm6yts0j7hdgggvq53hrzfr0vfyhvv/T/RtmpiSqthE/8cafc316c0bf32ba1bffad801cd3b7b2d886ff24_2"</code></pre>
</div>
<div id="pipeline-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#pipeline-plot" class="anchor"></a>Pipeline plot</h2>
<p>The function <code>plotCWL</code> can be used to visualize the relationship of inputs, outputs and the analysis for a tool or pipeline.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotCWL.html">plotCWL</a></span><span class="op">(</span><span class="va">cwl</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div id="htmlwidget-d29d5a5f27a4bd1045cb" style="width:700px;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-d29d5a5f27a4bd1045cb">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"cwl_zfile\", shape = \"rectangle\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,4!\"] \n  \"2\" [label = \"cwl_cout\", shape = \"circle\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,1!\"] \n  \"3\" [label = \"Uncomp\", shape = \"diamond\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,3!\"] \n  \"4\" [label = \"Compile\", shape = \"diamond\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"0,2!\"] \n  \"1\"->\"3\" \n  \"3\"->\"4\" \n  \"4\"->\"2\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="web-application" class="section level1">
<h1 class="hasAnchor">
<a href="#web-application" class="anchor"></a>Web Application</h1>
<div id="cwlprocess-example" class="section level2">
<h2 class="hasAnchor">
<a href="#cwlprocess-example" class="anchor"></a>cwlProcess example</h2>
<p>Here we build a tool with different types of input parameters.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"flag"</span>, type <span class="op">=</span> <span class="st">"boolean"</span>,
                 prefix <span class="op">=</span> <span class="st">"-f"</span>, doc <span class="op">=</span> <span class="st">"boolean flag"</span><span class="op">)</span>
<span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"string"</span>, type <span class="op">=</span> <span class="st">"string"</span>, prefix <span class="op">=</span> <span class="st">"-s"</span><span class="op">)</span>
<span class="va">e3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"option"</span>, type <span class="op">=</span> <span class="st">"string"</span>, prefix <span class="op">=</span> <span class="st">"-o"</span><span class="op">)</span>
<span class="va">e4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"int"</span>, type <span class="op">=</span> <span class="st">"int"</span>, prefix <span class="op">=</span> <span class="st">"-i"</span>, default <span class="op">=</span> <span class="fl">123</span><span class="op">)</span>
<span class="va">e5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"file"</span>, type <span class="op">=</span> <span class="st">"File"</span>,
                 prefix <span class="op">=</span> <span class="st">"--file="</span>, separate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">e6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"array"</span>, type <span class="op">=</span> <span class="st">"string[]"</span>, prefix <span class="op">=</span> <span class="st">"-A"</span>,
                 doc <span class="op">=</span> <span class="st">"separated by comma"</span><span class="op">)</span>
<span class="va">mulEcho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="st">"echo"</span>, id <span class="op">=</span> <span class="st">"mulEcho"</span>,
                 label <span class="op">=</span> <span class="st">"Test parameter types"</span>,
                 inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">e1</span>, <span class="va">e2</span>, <span class="va">e3</span>, <span class="va">e4</span>, <span class="va">e5</span>, <span class="va">e6</span><span class="op">)</span>,
                 stdout <span class="op">=</span> <span class="st">"output.txt"</span><span class="op">)</span>
<span class="va">mulEcho</span></code></pre></div>
<pre><code>## class: cwlProcess 
##  cwlClass: CommandLineTool 
##  cwlVersion: v1.0 
##  baseCommand: echo 
## inputs:
##   flag (boolean): -f 
##   string (string): -s 
##   option (string): -o 
##   int (int): -i 123
##   file (File): --file= 
##   array (string[]): -A 
## outputs:
## output:
##   type: stdout
## stdout: output.txt</code></pre>
</div>
<div id="cwlprocess-to-shiny-app" class="section level2">
<h2 class="hasAnchor">
<a href="#cwlprocess-to-shiny-app" class="anchor"></a>cwlProcess to Shiny App</h2>
<p>Some input parameters can be predefined in a list, which will be converted to select options in the webapp. An <code>upload</code> parameter can be used to defined wether to generate an upload interface for the file type option. If FALSE, the upload field will be text input (file path) instead of file input.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inputList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>option <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"option1"</span>, <span class="st">"option2"</span><span class="op">)</span><span class="op">)</span>
<span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlShiny.html">cwlShiny</a></span><span class="op">(</span><span class="va">mulEcho</span>, <span class="va">inputList</span>, upload <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">runApp</span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="cwlShiny.png" alt=""><p class="caption">shinyApp</p>
</div>
</div>
</div>
<div id="working-with-r-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-r-functions" class="anchor"></a>Working with R functions</h1>
<p>We can wrap an R function to <code>cwlProcess</code> object by simply assigning the R function to <code>baseCommand</code>. This could be useful to summarize results from other tools in a pipeline. It can also be used to benchmark different parameters for a method written in R. Please note that this feature is only implemented by <code>Rcwl</code>, but not available in the common workflow language.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fun1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="va">x</span><span class="op">*</span><span class="fl">2</span>
<span class="va">testFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu">fun1</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="va">b</span><span class="op">^</span><span class="fl">2</span>, sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="st">"fun1"</span>, <span class="va">fun1</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="st">"testFun"</span>, <span class="va">testFun</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"a"</span>, type <span class="op">=</span> <span class="st">"int"</span>, prefix <span class="op">=</span> <span class="st">"a="</span>, separate <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InputParam-class.html">InputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"b"</span>, type <span class="op">=</span> <span class="st">"int"</span>, prefix <span class="op">=</span> <span class="st">"b="</span>, separate <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OutputParam-class.html">OutputParam</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"o"</span>, type <span class="op">=</span> <span class="st">"File"</span>, glob <span class="op">=</span> <span class="st">"rout.txt"</span><span class="op">)</span>
<span class="va">TestFun</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cwlProcess-class.html">cwlProcess</a></span><span class="op">(</span>baseCommand <span class="op">=</span> <span class="va">testFun</span>,
                    inputs <span class="op">=</span> <span class="fu"><a href="../reference/InputParamList-class.html">InputParamList</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span>,
                    outputs <span class="op">=</span> <span class="fu"><a href="../reference/OutputParamList-class.html">OutputParamList</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span>,
                    stdout <span class="op">=</span> <span class="st">"rout.txt"</span><span class="op">)</span>
<span class="va">TestFun</span><span class="op">$</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">TestFun</span><span class="op">$</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCWL.html">runCWL</a></span><span class="op">(</span><span class="va">TestFun</span>, cwlArgs <span class="op">=</span> <span class="st">"--preserve-entire-environment"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1;30mINFO[0m Final process status is success</code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">output</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "6"</code></pre>
<p>The <code>runCWL</code> function wrote the <code>testFun</code> function and its dependencies into an R script file automatically and call <code>Rscript</code> to run the script with parameters. Each parameter requires a prefix from corresponding argument in the R function with “=” and without a separator. Here we assigned the R function and its dependencies into the global environment because it will start a new environment when the vignette is compiled.</p>
</div>
<div id="resources" class="section level1">
<h1 class="hasAnchor">
<a href="#resources" class="anchor"></a>Resources</h1>
<div id="rcwlpipelines" class="section level2">
<h2 class="hasAnchor">
<a href="#rcwlpipelines" class="anchor"></a>RcwlPipelines</h2>
<p>The <code>Rcwl</code> package can be utilized to develop pipelines for best practices of reproducible research, especially for Bioinformatics study. Multiple Bioinformatics pipelines, such as RNASeq alignment, quality control and quantification, DNASeq alignment and variant calling, have been developed based on the tool in an R package <code>RcwlPipelines</code>, which contains the CWL recipes and the scripts to create the pipelines. Examples to analyze real data are also included.</p>
<p>The package is currently available in github.</p>
<ul>
<li><a href="https://github.com/hubentu/RcwlPipelines" class="uri">https://github.com/hubentu/RcwlPipelines</a></li>
</ul>
<p>To install the package.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"hubentu/RcwlPipelines"</span><span class="op">)</span></code></pre></div>
<p>More recipes will be collected in this package and we would like to invite community to submit more pipelines to this package.</p>
</div>
<div id="tool-collections-in-cwl-format" class="section level2">
<h2 class="hasAnchor">
<a href="#tool-collections-in-cwl-format" class="anchor"></a>Tool collections in CWL format</h2>
<p>Plenty of Bioinformatics tools and workflows can be found from github in CWL format. They can be imported to <code>cwlProcess</code> object by <code>readCWL</code> function, or can be used directly.</p>
<ul>
<li><a href="https://github.com/common-workflow-language/workflows" class="uri">https://github.com/common-workflow-language/workflows</a></li>
<li><a href="https://github.com/Duke-GCB/GGR-cwl" class="uri">https://github.com/Duke-GCB/GGR-cwl</a></li>
<li><a href="https://github.com/pitagora-galaxy/cwl" class="uri">https://github.com/pitagora-galaxy/cwl</a></li>
</ul>
</div>
<div id="docker-for-bioinformatics-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#docker-for-bioinformatics-tools" class="anchor"></a>Docker for Bioinformatics tools</h2>
<p>Most of the Bioinformatics software are available in docker containers, which can be very convenient to be adopted to build portable CWL tools and pipelines.</p>
<ul>
<li><a href="https://dockstore.org" class="uri">https://dockstore.org</a></li>
<li><a href="https://biocontainers.pro" class="uri">https://biocontainers.pro</a></li>
</ul>
</div>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>SessionInfo</h1>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R Under development (unstable) (2020-12-09 r79601)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: macOS Big Sur 11.1
## 
## Matrix products: default
## BLAS/LAPACK: /Users/qi28068/miniconda3/envs/r-dev/lib/libopenblasp-r0.3.12.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
## [1] Rcwl_1.7.7          S4Vectors_0.29.6    BiocGenerics_0.37.0
## [4] yaml_2.2.1          BiocStyle_2.19.1   
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.6           lattice_0.20-41      tidyr_1.1.2         
##  [4] prettyunits_1.1.1    visNetwork_2.0.9     assertthat_0.2.1    
##  [7] rprojroot_2.0.2      digest_0.6.27        mime_0.9            
## [10] R6_2.5.0             backports_1.2.1      evaluate_0.14       
## [13] pillar_1.4.7         basilisk_1.3.6       rlang_0.4.10        
## [16] progress_1.2.2       rstudioapi_0.13      data.table_1.13.6   
## [19] R.utils_2.10.1       R.oo_1.24.0          Matrix_1.3-2        
## [22] checkmate_2.0.0      reticulate_1.18      rmarkdown_2.6       
## [25] DiagrammeR_1.0.6.1   pkgdown_1.6.1        textshaping_0.2.1   
## [28] desc_1.2.0           BiocParallel_1.25.3  stringr_1.4.0       
## [31] htmlwidgets_1.5.3    igraph_1.2.6         shiny_1.5.0         
## [34] compiler_4.1.0       httpuv_1.5.5         xfun_0.20           
## [37] pkgconfig_2.0.3      systemfonts_0.3.2    htmltools_0.5.1.1   
## [40] tidyselect_1.1.0     tibble_3.0.5         bookdown_0.21       
## [43] batchtools_0.9.15    codetools_0.2-18     dplyr_1.0.3         
## [46] crayon_1.3.4         withr_2.4.0          later_1.1.0.1       
## [49] R.methodsS3_1.8.1    rappdirs_0.3.1       basilisk.utils_1.3.5
## [52] grid_4.1.0           DBI_1.1.1            jsonlite_1.7.2      
## [55] xtable_1.8-4         lifecycle_0.2.0      magrittr_2.0.1      
## [58] stringi_1.5.3        fs_1.5.0             promises_1.1.1      
## [61] generics_0.1.0       ellipsis_0.3.1       brew_1.0-6          
## [64] filelock_1.0.2       ragg_0.4.1           vctrs_0.3.6         
## [67] RColorBrewer_1.1-2   tools_4.1.0          glue_1.4.2          
## [70] purrr_0.3.4          hms_1.0.0            fastmap_1.0.1       
## [73] BiocManager_1.30.10  base64url_1.4        memoise_1.1.0       
## [76] knitr_1.30</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Qiang Hu, Qian Liu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
